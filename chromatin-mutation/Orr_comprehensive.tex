\input{header}
%lung, colon, and stomach?

\begin{document}
% \section{Title}
% \maketitle

% \section{Project Summary/Abstract}

% \input{abstract}

% \clearpage

\section{Specific Aims} %1 page

\input{aims}

\clearpage

% 6 pages
% Significance : Recommended Length: Approximately 0.5-1 pages 
% Innovation : Recommended Length: The recommended length of the innovation section is 0.25-0.5
% Approach : Recommended Length: The maximum recommended length of the approach section is 4.5-5 pages. 

\section{Significance}

% why study somatic mutation?
Somatic mutations are mutations that occur in somatic cells, and as such are not passed to offspring.
These mutations arise due to errors in DNA replication preceding cell division.
While the DNA replication and error repair machinery is highly accurate, mutations occur at high enough frequencies to be significant.
Current assumptions of error rate and genome size imply that on average each cell division results in the accumulation of one novel mutation in the daughter cells.

These mutations are central to the somatic mutation theory of cancer.
This theory posits that cancers arise in multicellular organisms when somatic cells of that organism accumulate a sufficient number of mutations in oncogenes or tumor suppressor genes induces tumorigenesis.
Important mutations in oncogenes cause them to be over activated, promoting unnecessary cell proliferation.
In contrast, relevant mutations in tumor suppressor genes cause them to lose functionality, inhibiting their ability to limit cell proliferation.
Once a sufficient number of these mutations accumulate, the cell divides rapidly and accumulates even more somatic mutations, severely destabilizing the genome.
Thus, understanding how somatic mutations accumulate in healthy cells is vital to understanding the onset and progression of cancer. 

%why study chromatin accessibility?
A similarly important factor required for the onset of cancer is the deregulation of chromatin.
The chromatin state in a region of the genome is determined by the organization of the nucleosomes in the region.
These nucleosomes are composed of histones, which bind and organize a segment of DNA.
While the function of higher orders of organization is not well understood, the function and impact of different chromatin states is clear.
Chromatin takes two important possible states: heterochromatin, in which the DNA is tightly packaged; and euchromatin, in which the DNA is loosely packaged.
In the heterochromatin state, translation is repressed as the DNA is inaccessible to translation proteins.
In the euchromatin state, translation can occur as the DNA is available for translation complexes to bind.

As the chromatin state significantly impacts translational ability, and different tissues must express different genes to maintain their identity, different tissues have different distributions of chromatin states.
The process of switching between these states is known as chromatin remodeling.
As cancers require normally silenced genes to be expressed, misregulated chromatin remodeling is important for tumorigenesis.
In fact, many genes implicated as oncogenes or tumor suppressor genes have functions important for chromatin remodeling.
As such, understanding how these epigenetic changes cause disease is vital to understanding and preventing cancer.


% why study the interface of somatic mutation and chromatin accessibility?
Thus, it is apparent that a comprehensive understanding of cancer onset requires integrating both somatic mutation and epigenetic misregulation.
The somatic mutation theory of cancer can explain both components, as mutations in chromatin remodeling proteins can cause the large-scale changes in expression required for tumors to form and thrive.
Some critics claim that the theory inadequately explains how the requisite mutations are obtained.
As somatic mutations occur at very low frequency, the probability of accumulating the number of required mutations in the correct sites and within the same cell is low.
A potential resolution to this inconsistency is the observation that mutation rates are not evenly distributed across the genome.
That is, mutation rates could be high enough in regions that contain oncogenes and tumor suppressor genes that mutating a sufficient number of them can occur with probabilities consistent with rates of cancer incidence.

Recently, many groups have reported a strong association between regional variation in somatic mutation rates in tumors and chromatin states in that region.
This pattern has also been seen in germline mutations.
Thus, it is highly likely that chromatin states impact local mutation rates in healthy somatic tissues as well.
Because chromatin remodeling is an important aspect of cell differentiation, different tissues have different patterns of chromatin states.
This implies that different tissues have different distributions of mutation rates.

One observation that indicates that this difference may be significant for studying cancer is that different tissues have different rates of cancer incidence.
There is debate about how much of this difference can be attributed to difference in cell division rates between different tissues.
However, differences in chromatin states of oncogenes and tumor suppressor genes in healthy somatic tissue may play an important role.

% Aim 1 of this project is to develop a novel bioinformatic pipeline to detect somatic mutations and estimate chromatin accessibility across the genome in somatic samples.

% why do we need a method to jointly detect somatic mutations and chromatin accessibility?
Despite the central role of somatic mutations in cancer development, they remain difficult to study.
However, if a relationship between chromatin accessibility and mutation rate exists, this can be explicitly modeled to improve detection of somatic mutations.
At the same time, sequencing-based assays of chromatin accessibility hold underlying genotype information.
Thus, considering both types of data at the same time and integrating information from both data sources into a model will increase the ability of the researcher to sensitively and accurately detect somatic mutations.

With this ability, researchers will be able to study somatic mutation in healthy tissue much more easily than previously.
Because the sequencing reads provided by the accessibility assay can be used to estimate genotypes in low-depth regions, researchers can achieve higher-quality genotypes with less sequencing depth.
This could result in lower sequencing costs, which can be an issue when studying somatic mutations due to the high sequencing depth required with traditional methods.
Additionally, this method may be a useful alternative or supplement to current methods used to detect somatic mutations within tumors.

% how will this method change the field if it is achieved?
% reduce sequencing costs - less covg necessary initially, doesn't throw away  information from ATAC-seq
% 

%%%%%%%%%%%%% aim 2 %%%%%%%%%%%%%%%%

% Aim 2 of this project is to test the hypothesis that chromatin accessibility significantly impacts mutation rate.

% why study the interaction of somatic mutation and chromatin accessibility? 

% how will this aim change the field if it is achieved?

% 1. Significance
% Explain the importance of the problem or critical barrier to progress that the proposed project addresses.
% Explain how the proposed project will improve scientific knowledge, technical capability, and/or clinical practice in one or more broad fields.
% Describe how the concepts, methods, technologies, treatments, services, or preventative interventions that drive this field will be changed if the proposed aims are achieved.

\section{Innovation}
% Explain how the application challenges and seeks to shift current research or clinical practice paradigms.
% Describe any novel theoretical concepts, approaches or methodologies, instrumentation or interventions to be developed or used, and any advantage over existing methodologies, instrumentation, or interventions.
% Explain any refinements, improvements, or new applications of theoretical concepts, approaches or methodologies, instrumentation, or interventions.

While there has been a large body of work on the generation of somatic mutations in the presence of mutagens, much less is known about the endogenous process that generates somatic mutations--that is, the process that generates somatic mutations even in cells that are never exposed to mutagens or unusual stress.
% Despite the critical role somatic mutations play in tumorigenesis, these mutations are usually studied only in tumors, as there are a sufficient number of mutations that a significant number can be detected at modest sequencing depth.
% However, most of these mutations did not cause the tumor, and occur only after the tumor has formed.
This impedes researchers' ability to detect significant departures from healthy levels and patterns of somatic mutation; a significant amount of energy is expended in differentiating non-pathogenic "passenger" mutations from the "driver" mutations that actually contribute to tumor formation.
This knowledge gap is largely due to the technical difficulty of detecting somatic mutations in healthy tissues.
In any sample of healthy tissue, the number of somatic mutations within the sample is expected to be orders of magnitude smaller than the number of sequencing errors.
A reliable method of detecting somatic mutations in healthy cells and non-tumor samples will enable researchers to study somatic mutations in healthy tissue, improving their ability to distinguish between natural patterns of somatic variation and unhealthy levels of somatic variation indicative of disease.

% what's new about considering somatic mutations along with chromatin accessibility?

% - healthy somatic tissue rather than germline or cancer tumor
% - design allows detection of irregularities due to increased cancer risk
% - show how a proactive approach to predicting cancer vulnerability could be used for screening

\section{Approach}
\subsection{Aim 1}
\subsubsection{Pipeline Inputs}
The low frequency of mutations in somatic cells can make them difficult to detect.
At the same time, errors introduced while sequencing occur at far greater frequency.
Great care must be taken when using software tools for detecting somatic mutations, as sequencing errors can cause high false positive rates.

A significant number of mutations are expected to occur in microsatellites.
These regions are some of the most variable in the genome, and have been demonstrated to mutate frequently even in somatic cells.
Short sequencing reads are often difficult to map to these repeat-rich regions, so a bioinformatic method to detect mutations in these regions should incorporate long sequencing reads. At the same time, long sequencing reads are particularly error prone, causing them to make more errors when reporting the nucleotide within the sequencing read. Thus, the pipeline should be able to accomodate short sequencing reads as a method for accurately detecting point mutations and long sequencing reads for accurately detecting insertions and deletions.

For the long read platform, Oxford Nanopore is preferred because the electrical signal used to sequence the input DNA also contains information that can be used to detect methylated cytosines without additional library preparation. This information will be used to validate nucleosome occupancy information. That this information can be extracted from the same sequencing run is significant, as the the amount of sampled tissue will be too small to perform a separate bisulfite sequencing reaction.

Oxford Nanopore sequencing can be done in one of two ways: 1D sequencing and 2D sequencing.
In 2D Oxford Nanopore sequencing, each complementary strand of DNA is connected by a hairpin loop. As the DNA is pulled through the pore, the hairpin loop is computationally recognized by the sequencer. It then knows that the sequence following is from the complementary strand of DNA, and uses that information to correct potential errors before outputting the bases contained in the read.
Therefore, 2D Oxford Nanopore reads should be used because they contain fewer errors than 1D reads.

Thus, the pipeline will accept as inputs: 1) a set of short paired end Illumina genome sequencing reads from a somatic tumor and somatic normal sample, 2) a set of Oxford Nanopore 2D genome sequencing reads from a somatic tumor and somatic normal sample, 3) a set of Illumina sequencing reads generated by an ATAC-seq protocol of the somatic tumor sample, and 4) the reference of the genome to which the reads will be aligned. The Illumina reads should be in FASTQ format, the Oxford Nanopore reads should be in FAST5 format, and the reference genome should be in FASTA format.
%TODO: specify that reads from a matched normal sample are also required

\subsubsection{Read Correction}
While 2D Nanopore data contains fewer errors than 1D data, it remains far more error prone than short read data.
And while short reads have relatively few errors, they do contain errors that can cause ambiguity during variant detection.
To minimize the number of false positive mutation calls, the first step of the pipeline will be error correcting short reads with the Rcorrector package.

Rcorrector is an Illumina read corrector designed for use in RNA-seq experiments. Though it was designed for RNA sequencing reads, it performs as well as alternatives on whole genome sequencing reads and has improved accuracy in regions with low coverage. Since we will use the pipeline on reads generated with low source DNA, potentially causing highly variable levels of coverage, Rcorrector is the best program for this step.

The Rcorrector parameter that has the most impact on the analysis is the kmer size used to detect and repair errors. To identify the best value of \textit{k} to use, the reads will be corrected using each odd value from 15 to 31. This range was chosen to be centered on the default value of 23 and have an equal number of values on each side of 23 without going over the maximum value the program supports, 32. Each set of corrected reads will be aligned to the reference genome with the BWA software. The mem alignment algorithm will be used with default parameters. The set of corrected reads that produced the alignment with the fewest mismatches will be used for downstream analyses.

The corrected short reads can be used to detect and correct errors in the long reads. To do this, the Nanocorr software package will be used. This software uses BLAST to align the short reads to each long read and changes bases with discrepancies to those from the short reads. This method has no tunable parameters. Nanocorr is used for this step in the pipeline because it uses short reads to correct the long reads, rather than relying on the overlaps between long reads. Since the pipeline uses both types of reads, this type of correction is possible and is more accurate than relying on long reads alone. This will be done for both sets of long reads; those from the control sample will be corrected using the short reads from the control sample, and the long reads from the experimental sample will be corrected using the short reads from the experimental sample.

\subsubsection{Alignment}

After correction, the sequencing reads should more accurately reflect the DNA of the sequenced sample. However, they still may contain some errors. Additionally, as some of samples planned to be sequenced in this experiment are tumors and may be significantly diverged from the reference genome, a read aligner capable of aligning noisy, divergent reads must be used.

Minimap2 is a program designed for this purpose. Additionally, Minimap2 supports alignment with both Illumina and Nanopore reads. As such, it will be used to align the reads to the reference genome.
Minimap2 has suggested sets of parameters for different types of data. For mapping the Illumina reads, \textit{-x sr} will be used to indicate that short reads will be mapped. For mapping long reads, \textit{-x map-ont} will be used to indicate that long reads from an Oxford Nanopore will be mapped. Minimap does not map both reads at the same time, so the operations will be done independently. For both executions of the program, the \textit{-a} option will be specified to signify that the output should be in SAM format. Additionally, the \textit{--cs} option will be used to add a CIGAR string tag to the SAM output. This option is necessary to properly encode CIGAR information for very long reads due to a defect in the BAM specification. After this step, two BAM files will be produced for each sample; one with aligned Nanopore reads and one with aligned Illumina reads.

\subsubsection{Variant Detection}

%nanopolish
Due to the length of the Nanopore reads, they are well suited for detecting structural variation. To do so, the Nanopolish software package will be used. Nanopolish uses the raw electrical signal data produced by the nanopore during sequencing. Thus, prior to calling variants, the \textit{eventalign} command of Nanopolish must be run to produce an alignment of the electrical signals to each of the reads. Then, the \textit{variants} command of Nanopolish can be used. Nanopolish was chosen to call variants as it is the current standard in the field for variant calling using Oxford Nanopore data. An alternative method, Poreseq, has recently been introduced \parencite{szalay_novo_2015}. While the performance of the two softwares' variant calling program have not been compared, the consensus generating functions of both packages have (see discussion of \cite{szalay_novo_2015}), and Nanopolish was found to be slightly more accurate. At the conclusion of this step, a VCF containing structural and single nucleotide variants will be produced for each sample.

%mutect2
While long reads are helpful for finding structural variants, they are deficient in accurately identifying single nucleotide variants. As such, these variants will be detected using the short Illumina reads. Since the sequenced samples are solid tissue and may be highly heterogeneous cancer tumors, the MuTect2 software will be used to call variants. MuTect2 detects mutations by modeling the likelihood of the 3 possible mutations with a uniform error rate and considering any base where the log ratio of the likelihood of a true mutation of that base to no mutation exceeds a threshold. It then estimates the fraction of the sample containing the mutation; if it is sufficiently large, the mutation is emitted.

Before MuTect2 can be used, optical duplicates must be removed from the normal and experimental short read BAM alignments. The authors of MuTect2 recommend this be done using the Picard package's \textit{MarkDuplicates} command. This command has no parameters, and results in a new BAM alignment for each input. Additionally, MuTect2 expects base quality scores to be recalibrated. Base quality scores reflect sequencing machine's predicted probability of committing an error when it emitted that base. These scores can be biased such that the values no longer represent the true probability of error. However, this can be detected and reverted \textit{in silico} using the Genome Analysis Toolkit's BaseRecalibrator tool and a database of variable sites. These sites are ignored, and the covariance between base quality score and estimated error rate is modeled. Each base quality score is then adjusted to the value predicted by the model. The database of variable sites will be taken from the European Variation Archive, as NCBI is removing support for storing non-human variation data. There are no other tunable parameters for BaseRecalibrator. At the conclusion of this step there will be two BAM files with optical duplicates marked and recalibrated base quality scores; one containing reads from an experimental sample, and one containing reads from a control sample.

At this point, the BAM files are suitable for use with MuTect2 to detect mutations in the cancer sample. After MuTect2 is run, a single VCF file is generated that contains the somatic mutations detected in the cancer sample.

%combine vcfs
\subsubsection{Variant Processing}
%snps in short reads trusted, sv's in long reads trusted
The variants detected by MuTect2 using the short reads will be combined with those detected by Nanopolish using long reads. As short reads are deficient in detecting large structural variation and long reads are deficient in detecting single nucleotide variation, only single nucleotide changes and short (less than 10 bp) insertion/deletion variants will be considered from the variants detected by MuTect2. Likewise, only structural variants will be considered from the variants detected using Nanopolish.
Filtering and merging of the variant sets will be performed using the vcftools package.

%chromatin accessibility with NucleoATAC
\subsubsection{Chromatin Accessibility Assay}
To estimate the chromatin accessibility at the locations of each of these detected somatic mutations, the reads from the ATAC-seq assay will be used in combination with the MACS (Model-based Analysis of ChIP-Seq) software package. MACS models read counts with a Poisson distribution and tests whether the depth in a particular region is significantly higher than expected by chance. It then outputs a BED file containing the regions which experienced significant enrichment in read depth. MACS was chosen for peak detection as alternative methods have been shown to be less accurate.

MACS requires the input data to be aligned to the genome. A large proportion of ATAC-seq reads align to the mitochondria, as it is nonnuclear DNA and highly accessible to the transposase employed in the assay. Thus, the ATAC-seq reads will be aligned to the genome using Minimap with the \textit{-x sr} option, as described above. This alignment will then be filtered to remove reads mapping to the mitochondrial region using the samtools software package. The accuracy of enrichment values calculated by MACS can be improved by providing a control input. This control will be the aligned genomic short reads created earlier. However, like the alignment generated by the ATAC-seq reads, reads mapping to the mitochondrial genome will be removed.

To use MACS for ATAC-seq analysis, a few parameters must be set.
MACS requires the user to set the estimated mappable genome size; as such, \textit{-g mm} will be used to specify that the reads are from a mouse genome. Additionally, since paired reads will be used, the \textit{--nomodel} option will be set to indicate that MACS should not attempt to model the insert size and calculate it from the read pairs. This will produce a BED file containing genomic regions which are significantly enriched for ATAC-seq reads. This suggests that these regions are enriched for open chromatin.

Finally, the mutations detected earlier in the pipeline must be compared with these regions to determine whether they fall in open or closed chromatin regions. To do so, the \textit{intersect} command of the bedtools software package will be used. Using the \textit{-c} option will output the number of mutations in each region. Running the tool again, but using the \textit{-v} option, will output the mutations that do not overlap any enrichment region.

%MACS gives fold enrichment - poisson

%is there a correlation between in-region and out-of-region mutation counts?

% in significant regions, is there a relationship between fold-enrichment and number of mutations?

% for each mutation, what is the distribution of enrichment values?

%validation
\subsubsection{Pipeline Validation}
%TODO: mix two cell lines. run pipeline using sequence frm 1 as matched normal. see if differences in other cell line can be detected. for second

%try to find a line already analyzed by ATAC-seq. see how sig. peaks compare to those calculated w/ pipeline.

%alternative approaches
% only use short indels and snps detected by both nanopolish and mutect

\subsection{Aim 2}
To determine the relationship between mutation and chromatin accessibility and how that relationship changes in cancer, the pipeline described above will be applied on data generated by sequencing tumors and normal cells. As somatic mutations can be difficult to detect even in tumors, care must be taken to reduce technical error during sample processing and sequencing.

\subsubsection{Study Organisms}
Due to nonuniform sequencing depth and relatively high rates of sequencing error compared to mutation rates, even very sensitive methods will not detect every mutation. Therefore, in order to increase the number of mutations to detect a sufficient number for a meaningful analysis, many individuals should be sequenced. As this study aims to investigate how the relationship between chromatin accessibility changes in cancer and normal tissues, one group should have cancer and the other should not.
Additionally, the group of cancer afflicted individuals should reliably have tumors that can be sequenced. To reduce the effects of standing genetic variation, the cancer afflicted individuals should be as close to genetically identical as possible to the control individuals. Additionally, individuals of both groups should be as homozygous as possible to aid in mutation detection.

To meet all these requirements, mice will be used as the study species. In particular, C57Bl/6J mice will be used as the normal control group and C57Bl/6J-Apc\textsuperscript{Min}/J mice will be used as the experimental cancer group. These mice are heterozygous for a nonsense mutation in the \textit{Apc} gene that creates a nonfunctional protein product. \textit{Apc} is a tumor suppressor gene. Once a mutation in the sole functional copy of \textit{Apc} is obtained that causes a loss or reduction in function, the cell harboring the mutation proliferates rapidly. This most often occurs in the intestine, where many polyps form. In the process of this rapid proliferation, one polyp is likely to acquire additional mutations that cause a malignant tumor to form. Both strains of mice are readily available from Jackson labs.

\subsubsection{Power Analysis}

The distribution of accessibility values for each mutation is not known. However, assuming the distribution is Poisson can assist in approximating an appropriate sample size for the experiment. Additionally, assume an average coverage of 5X for the coverage of a mutated site. The square root of a Poisson distribution is approximately normally distributed with mean $\sqrt{\lambda}$ and standard deviation 0.25.
By Lehr's equation, to distinguish between two rates $\lambda_1$ and $\lambda_2$ with power $1 - \beta$ and significance level $\alpha$, the required number of observations is $\frac{2 * (Z_{1 - \frac{\alpha}{2}} + Z_{1 - \beta})^2}{{\sqrt{\lambda_1} - \sqrt{\lambda_2}}^2}$. With $\alpha$ = 0.05 and $\beta$ = 0.2, a 5\% increase in the rate parameter from 5 to 5.25 can be detected using more than 1312 mutations.

Though base-pair level accuracies of 99.78\% have been achieved using mixed Illumina and Nanopore reads, assume only 50\% of all mutations are detected, and these are evenly distributed across all sample sources and relative chromatin accessibility. Literature estimates \parencite{behjati_genome_2014} of similar somatic mouse samples suggest greater than 160 base substitutions per sample, resulting in 80 detectable substitutions. Microsatellite insertions and deletions should occur at equal or greater frequencies, but to be conservative those will not be considered. Under these assumptions, the required number of mice to sample is 16.4. To ensure a sufficient number of somatic mutations are acquired, samples will be taken from 50 mice of each strain.


\subsubsection{Tissue Collection}

\subsubsection{Library Preparation}

\subsubsection{Statistical Analysis}

\section{References} %no limit

% \printbibliography

\end{document}